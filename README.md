# Coffee App

![coverage][coverage_badge]
[![style: very good analysis][very_good_analysis_badge]][very_good_analysis_link]
[![License: MIT][license_badge]][license_link]

Generated by the [Very Good CLI][very_good_cli_link] 🤖

A beautiful Flutter app that lets you discover and favorite coffee images from around the world. Built with clean architecture following Very Good Ventures' best practices.

---

## Features ☕

- **Random Coffee Discovery**: Load beautiful coffee images from the [Coffee API](https://coffee.alexflipnote.dev)
- **Favorites System**: Save your favorite coffee images for offline viewing with local caching
- **Design System**: Comprehensive design system with centralized colors, typography, and spacing
- **Internationalization**: Full i18n support with English and Spanish translations
- **Material Design 3**: Modern UI following Material Design 3 guidelines
- **Image Zoom**: Interactive image viewer with pinch-to-zoom functionality
- **Local Storage**: All favorites stored locally using SharedPreferences with image caching
- **Error Handling**: Graceful error states with retry functionality
- **Loading States**: Smooth loading indicators for better UX
- **Cross-Platform**: Native support for iOS and Android
- **Clean Architecture**: 4-layer VGV architecture (Data, Repository, Business Logic, Presentation)
- **Full Test Coverage**: 89 tests with 100% pass rate

---

## Architecture 🏗️

This app follows Very Good Ventures' 4-layer architecture:

### 📊 Data Layer
- **Remote DataSource**: Handles API communication with the coffee service
- **Local DataSource**: Manages local storage of favorite coffees
- **Models**: Data transfer objects with JSON serialization

### 🔄 Repository Layer
- **Repository Implementation**: Combines data sources and implements business rules
- **Repository Interface**: Abstract contract for data operations

### 🧠 Business Logic Layer
- **Use Cases**: Specific business operations (get random coffee, manage favorites)
- **Entities**: Core business objects
- **BLoC**: State management using flutter_bloc pattern

### 🎨 Presentation Layer
- **Pages**: Screen-level widgets
- **Widgets**: Reusable UI components
- **BLoC Events/States**: UI state management

---

## Getting Started 🚀

### Prerequisites

- Flutter SDK (>= 3.24.0)
- Dart SDK (>= 3.5.0)
- Xcode (for iOS development)
- Android Studio (for Android development)

### Installation

1. Clone the repository:
```sh
git clone <repository-url>
cd coffee_app
```

2. Install dependencies:
```sh
flutter pub get
```

3. Generate code:
```sh
dart run build_runner build --delete-conflicting-outputs
```

### Running the App

This project contains 3 flavors:

- development
- staging
- production

To run the desired flavor either use the launch configuration in VSCode/Android Studio or use the following commands:

```sh
# Development
$ flutter run --flavor development --target lib/main_development.dart

# Staging
$ flutter run --flavor staging --target lib/main_staging.dart

# Production
$ flutter run --flavor production --target lib/main_production.dart
```

_\*Coffee App works on iOS and Android._

---

## Running Tests 🧪

To run all unit and widget tests use the following command:

```sh
$ flutter test --coverage --test-randomize-ordering-seed random
```

To view the generated coverage report you can use [lcov](https://github.com/linux-test-project/lcov).

```sh
# Generate Coverage Report
$ genhtml coverage/lcov.info -o coverage/

# Open Coverage Report
$ open coverage/index.html
```

### Test Structure

```
test/
├── src/
│   └── coffee/
│       ├── data/
│       │   ├── datasources/
│       │   ├── models/
│       │   └── repositories/
│       ├── domain/
│       │   └── usecases/
│       └── presentation/
│           └── bloc/
```

---

## API Integration 🌐

The app integrates with the [Coffee API](https://coffee.alexflipnote.dev) to fetch random coffee images:

- **Endpoint**: `https://coffee.alexflipnote.dev/random.json`
- **Response Format**:
```json
{
  "id": "unique-coffee-id",
  "file": "https://coffee-image-url.jpg"
}
```

---

## Dependencies 📦

### Core Dependencies
- `flutter_bloc`: State management
- `get_it`: Dependency injection
- `http`: HTTP client for API calls
- `shared_preferences`: Local storage
- `path_provider`: File system paths
- `google_fonts`: Custom fonts (Poppins)
- `equatable`: Value equality
- `json_annotation`: JSON serialization
- `flutter_localizations`: Internationalization support

### Development Dependencies
- `very_good_analysis`: Linting rules
- `build_runner`: Code generation
- `json_serializable`: JSON serialization codegen
- `mocktail`: Testing framework
- `bloc_test`: BLoC testing utilities

---

## Design System 🎨

The app implements a comprehensive design system located in `lib/src/core/design_system/`:

### Components

- **AppColors**: Centralized color palette with coffee-themed colors, semantic colors, and grey scale
- **AppTextStyles**: Material Design 3 compliant typography with app-specific styles
- **AppSpacing**: Consistent spacing values, padding, margins, and sizing constants
- **AppTheme**: Light and dark theme configurations with Material Design 3 support

### Usage

```dart
// Colors
Container(color: AppColors.primary)

// Text Styles
Text('Title', style: AppTextStyles.pageTitle)

// Spacing
Padding(padding: AppSpacing.paddingAllMedium)
SizedBox(height: AppSpacing.md)

// Theme
MaterialApp(theme: AppTheme.light)
```

All UI components use the design system - no hardcoded colors, sizes, or text styles!

---

## Working with Translations 🌐

This project relies on [flutter_localizations][flutter_localizations_link] and follows the [official internationalization guide for Flutter][internationalization_link].

### Adding Strings

1. To add a new localizable string, open the `app_en.arb` file at `lib/l10n/arb/app_en.arb`.

```arb
{
    "@@locale": "en",
    "coffeeAppBarTitle": "Coffee App",
    "@coffeeAppBarTitle": {
        "description": "Text shown in the AppBar of the Coffee App"
    }
}
```

### Adding Supported Locales

Update the `CFBundleLocalizations` array in the `Info.plist` at `ios/Runner/Info.plist` to include the new locale.

```xml
    ...
    <key>CFBundleLocalizations</key>
	<array>
		<string>en</string>
		<string>es</string>
	</array>
    ...
```

### Generating Translations

To use the latest translations changes, you will need to generate them:

```sh
flutter gen-l10n --arb-dir="lib/l10n/arb"
```

---

## Contributing 🤝

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

---

## License 📄

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## Acknowledgments 🙏

- [Very Good Ventures](https://verygood.ventures/) for the amazing CLI and architecture patterns
- [Coffee API](https://coffee.alexflipnote.dev) for providing beautiful coffee images
- Flutter community for the excellent tools and libraries

[coverage_badge]: coverage_badge.svg
[flutter_localizations_link]: https://api.flutter.dev/flutter/flutter_localizations/flutter_localizations-library.html
[internationalization_link]: https://flutter.dev/docs/development/accessibility-and-localization/internationalization
[license_badge]: https://img.shields.io/badge/license-MIT-blue.svg
[license_link]: https://opensource.org/licenses/MIT
[very_good_analysis_badge]: https://img.shields.io/badge/style-very_good_analysis-B22C89.svg
[very_good_analysis_link]: https://pub.dev/packages/very_good_analysis
[very_good_cli_link]: https://github.com/VeryGoodOpenSource/very_good_cli
